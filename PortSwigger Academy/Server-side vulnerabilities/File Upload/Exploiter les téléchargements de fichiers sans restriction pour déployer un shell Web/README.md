Exploiter les téléchargements de fichiers sans restriction pour déployer un shell Web
-------------------------------------------------------------------------------------

Du point de vue de la sécurité, le pire scénario possible est lorsqu'un site Web vous permet de télécharger des scripts côté serveur, tels que des fichiers PHP, Java ou Python, et est également configuré pour les exécuter en tant que code. Cela rend trivial de créer votre propre shell web sur le serveur.

#### Web shell

Un shell web est un script malveillant qui permet à un attaquant d'exécuter des commandes arbitraires sur un serveur web distant simplement en envoyant des requêtes HTTP au bon point de terminaison.

Si vous êtes en mesure de télécharger avec succès un shell web, vous avez effectivement un contrôle total sur le serveur. Cela signifie que vous pouvez lire et écrire des fichiers arbitraires, exfiltrer des données sensibles, même utiliser le serveur pour faire pivoter les attaques contre l'infrastructure interne et d'autres serveurs en dehors du réseau. Par exemple, le one-liner PHP suivant peut être utilisé pour lire des fichiers arbitraires à partir du système de fichiers du serveur:

`<?php echo file_get_contents('/path/to/target/file'); ?>`

Une fois téléchargé, l'envoi d'une demande pour ce fichier malveillant retournera le contenu du fichier cible dans la réponse.

Une coque Web plus polyvalente peut ressembler à ceci:

`<?php echo system($_GET['command']); ?>`

Ce script vous permet de passer une commande système arbitraire via un paramètre de requête comme suit:

`GET /example/exploit.php?command=id HTTP/1.1`
