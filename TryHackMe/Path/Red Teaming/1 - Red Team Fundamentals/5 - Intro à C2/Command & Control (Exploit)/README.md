### Exemple d'exploit

Énumération des hôtes avec Armitage

Avant de vous laisser partir seul, nous allons vous montrer comment exploiter un exemple de Machine Virtuelle. Tout d'abord, nous allons exécuter une analyse de port dans Armitage en allant dans la section "Hôtes", en survolant "Nmap Scan", et en sélectionnant "Quick Scan".

![6306202489d3cfdb126cd940ebb90896](https://github.com/dsgsec/Red-Team/assets/82456829/2855c57b-53bb-4d51-8076-6d58ebec6519)

*Sous-menu Armitage de Hosts -> Nmap Scan -> Quick Scan*

Après avoir sélectionné "Analyse rapide", une nouvelle option apparaîtra ; cela vous demandera d'entrer la plage d'adresses IP que vous souhaitez analyser. Vous devez entrer l'adresse IP de la machine virtuelle déployée dans cette case.

![1a12f245a88dbf0985a127e97e8a9734](https://github.com/dsgsec/Red-Team/assets/82456829/551e89f1-73a2-4279-8916-4f5ec766787a)

*Menu de saisie de "Enter Scan Range" avec l'adresse IP VICTIM_MACHINE*

Après avoir appuyé sur "Ok", et attendu un moment ou deux, vous devriez voir un nouvel onglet s'ouvrir appelé "nmap" et un nouvel écran de machine dans la fenêtre "Espace de travail". Dans l'onglet "nmap", vous verrez les résultats bruts de l'analyse.

![ef05d79307bdcf6326751ee531daa538](https://github.com/dsgsec/Red-Team/assets/82456829/44ce9f74-e9a1-43d7-a258-2fb1725f1696)

*Résultats du scan de port Nmap*

Maintenant que vous avez appris à exécuter une analyse de port de base, essayez d'exécuter diverses autres analyses sur la cible et voyez quelles informations supplémentaires vous pouvez récupérer d'un hôte.

*Astuce : une analyse complète saisira les bannières, énumérera les versions de logiciel, énumérera les versions de système d'exploitation , et bien plus encore !*

*\
*

Exploitation avec Armitage

Ensuite, nous allons montrer l'exploitation avec Armitage ; notre victime dans notre exemple est une machine Windows 7 (plus précisément, Blue). Cette machine est vulnérable à l'exploit classique "Eternal Blue". Pour trouver cela, nous nous concentrerons sur l'onglet le plus à droite avec les dossiers, nous développerons la liste déroulante "Exploit", puis trouverons la liste déroulante "Windows", puis la liste déroulante "SMB", puis vous verrez tous les exploits.

![0e382aaec1230fd7582b4d1ef2e5a5fb](https://github.com/dsgsec/Red-Team/assets/82456829/1a9b414f-5c6e-4b0b-ae86-a3dc964c70e7)

*Lister tous les exploits d'Armitage*

Ensuite, vous pouvez double-cliquer sur l'exploit de votre choix, ou faire glisser et déposer l'exploit sur l'hôte, et une nouvelle fenêtre s'ouvrira. Cliquer sur "lancer" déclenchera l'exploit.

![5db55dc8c10ed0048e6aa62f2291d260](https://github.com/dsgsec/Red-Team/assets/82456829/292bc9da-3a9e-4b53-b7d7-2ca7ad4fdb6f)

*Informations sur le module d'exploit Eternal Blue*

*\
*

Après avoir cliqué sur "Lancer", vous remarquerez qu'un nouvel onglet "Exploit" s'ouvre. Armitage exécutera toutes les vérifications régulières que Metasploit fait normalement. Dans le cas d'Eternal Blue, il a exécuté le script de vérification standard suivi du script d'exploitation jusqu'à ce qu'il obtienne un shell réussi. Il convient de noter que par défaut dans cet exploit, il a choisi un shell Bind. Assurez-vous de lire entièrement les informations et les options de l'exploit pour voir si un Bind Shell ou un Reverse Shell est une option.

![d26c03ba17e96c1e5ca70ca8a7b76260](https://github.com/dsgsec/Red-Team/assets/82456829/ff990013-9148-4f8a-80e2-b44a6920a175)

*Une tentative d'exploitation réussie d'Armitage*

Après avoir reçu votre shell, faites un clic droit sur l'hôte et sélectionnez "Interagir". Cela ouvrira un shell standard que vous connaissez bien. Afin d'obtenir un shell Meterpreter, nous vous recommandons d'exécuter le module multi/manage/shell_to_meterpreter.

![b08eff73b568e5d4ccc8d4be6a915b88](https://github.com/dsgsec/Red-Team/assets/82456829/7ecef9aa-2f8a-4caf-be39-a8751c2b850d)

*Hôte compromis à Armitage*

*\
*
