Introduction à IDOR
=============

* * * * *

Les vulnérabilités `Insecure Direct Object References (IDOR)` sont parmi les vulnérabilités Web les plus courantes et peuvent avoir un impact significatif sur l'application Web vulnérable. Les vulnérabilités IDOR se produisent lorsqu'une application Web expose une référence directe à un objet, comme un fichier ou une ressource de base de données, que l'utilisateur final peut contrôler directement pour obtenir l'accès à d'autres objets similaires. Si un utilisateur peut accéder à une ressource en raison de l'absence d'un système de contrôle d'accès solide, le système est considéré comme vulnérable.

Construire un système de contrôle d'accès solide est très difficile, c'est pourquoi les vulnérabilités IDOR sont omniprésentes. De plus, l'automatisation du processus d'identification des faiblesses dans les systèmes de contrôle d'accès est également assez difficile, ce qui peut conduire à ce que ces vulnérabilités ne soient pas identifiées jusqu'à ce qu'elles atteignent la production.

Par exemple, si les utilisateurs demandent l'accès à un fichier qu'ils ont récemment téléchargé, ils peuvent obtenir un lien vers celui-ci tel que (`download.php?file_id=123`). Ainsi, comme le lien référence directement le fichier avec (`file_id=123`), que se passerait-il si nous essayions d'accéder à un autre fichier (qui ne nous appartient peut-être pas) avec (`download.php?file_id=124`) ? Si l'application Web ne dispose pas d'un système de contrôle d'accès approprié sur le back-end, nous pourrons peut-être accéder à n'importe quel fichier en envoyant une requête avec son `file_id`. Dans de nombreux cas, nous pouvons constater que l' `id` est facilement devinable, ce qui permet de récupérer de nombreux fichiers ou ressources auxquels nous ne devrions pas avoir accès en fonction de nos autorisations.

* * * * *

Ce qui rend une vulnérabilité IDOR
--------------------------------

Le simple fait d'exposer une référence directe à un objet ou à une ressource interne n'est pas une vulnérabilité en soi. Cependant, cela peut permettre d'exploiter une autre vulnérabilité : un `système de contrôle d'accès faible`. De nombreuses applications Web empêchent les utilisateurs d'accéder aux ressources en les empêchant d'accéder aux pages, aux fonctions et aux API qui peuvent récupérer ces ressources. Cependant, que se passerait-il si un utilisateur accédait d'une manière ou d'une autre à ces pages (par exemple, via un lien partagé/deviné) ? Seraient-ils toujours en mesure d'accéder aux mêmes ressources en ayant simplement le lien pour y accéder ? Si l'application Web n'avait pas de système de contrôle d'accès sur le back-end qui compare l'authentification de l'utilisateur à la liste d'accès de la ressource, elle pourrait le faire.

Il existe de nombreuses façons de mettre en œuvre un système de contrôle d'accès solide pour les applications Web, comme un système de contrôle d'accès basé sur les rôles ([RBAC](https://en.wikipedia.org/wiki/Role-based_access_control)). Le principal point à retenir est qu'"une vulnérabilité IDOR existe principalement en raison de l'absence de contrôle d'accès sur le back-end". Si un utilisateur avait des références directes à des objets dans une application Web qui n'a pas de contrôle d'accès, il serait possible pour les attaquants d'afficher ou de modifier les données d'autres utilisateurs.

De nombreux développeurs ignorent la création d'un système de contrôle d'accès ; par conséquent, la plupart des applications Web et des applications mobiles ne sont pas protégées sur le back-end. Dans de telles applications, tous les utilisateurs peuvent avoir un accès arbitraire aux données de tous les autres utilisateurs sur le back-end. La seule chose qui empêcherait les utilisateurs d'accéder aux données d'autres utilisateurs serait la mise en œuvre frontale de l'application, qui est conçue pour afficher uniquement les données de l'utilisateur. Dans de tels cas, la manipulation manuelle des requêtes HTTP peut révéler que tous les utilisateurs ont un accès complet à toutes les données, conduisant à une attaque réussie.

Tout cela fait des vulnérabilités IDOR parmi les vulnérabilités les plus critiques pour toute application Web ou mobile, non seulement en raison de l'exposition de références directes d'objets, mais principalement en raison de l'absence d'un système de contrôle d'accès solide. Même un système de contrôle d'accès de base peut être difficile à développer. Un système de contrôle d'accès complet couvrant l'ensemble de l'application Web sans interférer avec ses fonctions pourrait être une tâche encore plus difficile. C'est pourquoi les vulnérabilités IDOR/Access Control se retrouvent même dans de très grandes applications Web, comme [Facebook](https://infosecwriteups.com/disclose-private-attachments-in-facebook-messenger-infrastructure-15-000-ae13602aa486) , [Instagram](https://infosecwriteups.com/add-description-to-instagram-posts-on-behalf-of-other-users-6500-7d55b4a24c5a) et [Twitter](https://medium.com /@kedrisec/publish-tweets-by-any-other-user-6c9d892708e3).

* * * * *

Impact des vulnérabilités IDOR
------------------------------

Comme mentionné précédemment, les vulnérabilités IDOR peuvent avoir un impact significatif sur les applications Web. L'exemple le plus élémentaire d'une vulnérabilité IDOR est l'accès aux fichiers privés et aux ressources d'autres utilisateurs qui ne devraient pas nous être accessibles, comme les fichiers personnels ou les données de carte de crédit, connus sous le nom de `IDOR Information Disclosure Vulnerabilities`. Selon la nature de la référence directe exposée, la vulnérabilité peut même permettre la modification ou la suppression des données d'autres utilisateurs, ce qui peut conduire à une prise de contrôle complète du compte.

Une fois qu'un attaquant a identifié les références directes, qui peuvent être des ID de base de données ou des paramètres d'URL, il peut commencer à tester des modèles spécifiques pour voir s'ils peuvent accéder à des données et éventuellement comprendre comment extraire ou modifier des données pour n'importe quel utilisateur arbitraire.

Les vulnérabilités IDOR peuvent également conduire à l'élévation des privilèges d'utilisateur d'un utilisateur standard à un utilisateur administrateur, avec `IDOR Insecure Function Calls`. Par exemple, de nombreuses applications Web exposent des paramètres d'URL ou des API pour des fonctions réservées aux administrateurs dans le code frontal de l'application Web et désactivent ces fonctions pour les utilisateurs non administrateurs. Cependant, si nous avions accès à ces paramètres ou API, nous pourrions les appeler avec nos privilèges d'utilisateur standard. Supposons que le back-end n'ait pas explicitement interdit aux utilisateurs non administrateurs d'appeler ces fonctions. Dans ce cas, nous pouvons être en mesure d'effectuer des opérations administratives non autorisées, telles que la modification des mots de passe des utilisateurs ou l'attribution de certains rôles aux utilisateurs, ce qui peut éventuellement conduire à une prise de contrôle totale de l'ensemble de l'application Web.
