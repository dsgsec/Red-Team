Exploits du noyau
===============

* * * * *

Des exploits au niveau du noyau existent pour diverses versions du noyau Linux. Un exemple très connu est [Dirty COW](https://github.com/dirtycow/dirtycow.github.io) (CVE-2016-5195). Ceux-ci exploitent les vulnérabilités du noyau pour exécuter du code avec les privilèges root. Il est très courant de trouver des systèmes vulnérables aux exploits du noyau. Il peut être difficile de suivre les systèmes hérités, et ils peuvent être exclus des correctifs en raison de problèmes de compatibilité avec certains services ou applications.

L'élévation de privilèges à l'aide d'un exploit de noyau peut être aussi simple que de le télécharger, de le compiler et de l'exécuter. Certains de ces exploits sont prêts à l'emploi, tandis que d'autres nécessitent des modifications. Un moyen rapide d'identifier les exploits consiste à émettre la commande `uname -a` et à rechercher sur Google la version du noyau.

Remarque : Les exploits du noyau peuvent entraîner une instabilité du système. Soyez donc prudent lorsque vous les exécutez sur un système de production.

* * * * *

Exemple d'exploitation du noyau
----------------------

Commençons par vérifier le niveau du noyau et la version du système d'exploitation Linux.

```
dsgsec@htb[/htb]$ uname -a

Linux NIX02 4.4.0-116-generic #140-Ubuntu SMP Lundi 12 février 21:23:04 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux

```

```
dsgsec@htb[/htb]$ cat /etc/lsb-release

DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=16.04
DISTRIB_CODENAME=xénial
DISTRIB_DESCRIPTION="Ubuntu 16.04.4 LTS"

```

Nous pouvons voir que nous sommes sur Linux Kernel 4.4.0-116 sur une boîte Ubuntu 16.04.4 LTS. Une recherche rapide sur Google pour `linux 4.4.0-116-generic exploit` donne [ce](https://vulners.com/zdt/1337DAY-ID-30003) exploit PoC. Ensuite, téléchargez-le sur le système à l'aide de `wget` ou d'une autre méthode de transfert de fichiers. Nous pouvons compiler le code d'exploitation en utilisant [gcc](https://linux.die.net/man/1/gcc) et définir le bit exécutable en utilisant `chmod +x`.

```
dsgsec@htb[/htb]$ gcc kernel_exploit.c -o kernel_exploit && chmod +x kernel_exploit

```

Ensuite, nous exécutons l'exploit et nous espérons être déposés dans un shell root.

```
dsgsec@htb[/htb]$ ./kernel_exploit

task_struct = ffff8800b71d7000
uidptr = ffff8800b95ce544
coquille de racine de frai

```

Enfin, nous pouvons confirmer l'accès root à la boîte.

```
root@htb[/htb]# whoami

root

```